---
import Layout from "../../layouts/Layout.astro";
import { getCollection, render } from "astro:content";
import BackButton from "../../components/atoms/BackButton.astro";

export async function getStaticPaths() {
  const posts = await getCollection("posts");
  return posts.map((post) => ({
    params: { slug: post.id },
  }));
}

const { slug } = Astro.params;
const posts = await getCollection("posts");
const article = posts.find((post) => post.id === slug);

if (!article) {
  return Astro.redirect("/404");
}

const { Content } = await render(article);
---

<Layout title={`${article.data.title} - Nils Haberkamp`}>
      <div class="container max-w-2xl mx-auto px-4 py-8">
        <div class="mb-8">
          <BackButton />
        </div>
        
        <article class="max-w-2xl mx-auto min-h-dvh">
          <h1 class="text-3xl font-medium mb-4 text-balance">{article.data.title}</h1>

          <div class="prose">
            <Content />
          </div>

          <div class="pt-32" />
        </article>
      </div>
</Layout>

